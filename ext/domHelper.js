// Generated by CoffeeScript 1.12.1
(function() {
  var createInfoNode, getSelectedImages, imageManager, template, whenTextAreaChange;

  imageManager = spexif.imageManager;

  template = (function() {
    var node;
    node = document.getElementById('template').getElementsByClassName('image-template')[0].cloneNode(true);
    node.className = 'image-info';
    return node;
  })();

  whenTextAreaChange = function() {
    var date, exif, gps, key, maker, ref, ref1, value;
    ref = this.value.split(/\n/g), date = ref[0], maker = ref[1], gps = ref[2];
    gps = gps.split(',');
    exif = this.parentNode.cacheImage.exif;
    ref1 = {
      date: date,
      maker: maker
    };
    for (key in ref1) {
      value = ref1[key];
      exif.key = value;
    }
    return exif.gps = gps.map(Number);
  };

  createInfoNode = function(cacheImage) {
    var exif, newNode, textarea;
    newNode = template.cloneNode(true);
    newNode.cacheImage = cacheImage;
    newNode.getElementsByTagName('img')[0].src = cacheImage.thumbnailImage.url;
    exif = cacheImage.exif;
    textarea = newNode.getElementsByTagName('textarea')[0];
    textarea.value = exif.date + "\n" + exif.maker + "\n" + exif.gps;
    textarea.onchange = whenTextAreaChange;
    return newNode;
  };

  getSelectedImages = function() {
    var checkbox, i, len, ref, results;
    ref = document.getElementsByTagName('input');
    results = [];
    for (i = 0, len = ref.length; i < len; i++) {
      checkbox = ref[i];
      if (checkbox.checked) {
        results.push(checkbox.parentNode.cacheImage);
      }
    }
    return results;
  };

  spexif.domHelper = {
    createInfoNode: createInfoNode,
    getSelectedImages: getSelectedImages
  };

}).call(this);
